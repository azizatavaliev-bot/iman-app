import{c as E,J as L,j as e,C as R,L as k,H as F,X as M}from"./index-NuxdLuKF.js";import{u as D,b as a}from"./vendor-CpRrxz-h.js";import{P as S}from"./plus-CplIAnb5.js";const J=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],U=E("send",J),b="",z=[{key:"health",label:"–ó–¥–æ—Ä–æ–≤—å–µ",icon:"üíö"},{key:"family",label:"–°–µ–º—å—è",icon:"üë®‚Äçüë©‚Äçüëß‚Äçüë¶"},{key:"guidance",label:"–ù–∞—Å—Ç–∞–≤–ª–µ–Ω–∏–µ",icon:"üåü"},{key:"rizq",label:"–†–∏–∑–∫",icon:"üí∞"},{key:"forgiveness",label:"–ü—Ä–æ—â–µ–Ω–∏–µ",icon:"ü§≤"},{key:"general",label:"–û–±—â–µ–µ",icon:"üìø"}],C=Object.fromEntries(z.map(d=>[d.key,d]));function G(d){const x=Date.now(),h=new Date(d).getTime(),i=x-h,m=Math.floor(i/6e4),n=Math.floor(i/36e5),l=Math.floor(i/864e5);return m<1?"—Ç–æ–ª—å–∫–æ —á—Ç–æ":m<60?m===1?"1 –º–∏–Ω –Ω–∞–∑–∞–¥":`${m} –º–∏–Ω –Ω–∞–∑–∞–¥`:n<24?n===1?"1 —á–∞—Å –Ω–∞–∑–∞–¥":n>=2&&n<=4?`${n} —á–∞—Å–∞ –Ω–∞–∑–∞–¥`:`${n} —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥`:l===1?"–≤—á–µ—Ä–∞":l>=2&&l<=4?`${l} –¥–Ω—è –Ω–∞–∑–∞–¥`:l<=30?`${l} –¥–Ω–µ–π –Ω–∞–∑–∞–¥`:new Date(d).toLocaleDateString("ru-RU",{day:"numeric",month:"short"})}function X(){const d=D(),[x,h]=a.useState([]),[i,m]=a.useState(!0),[n,l]=a.useState(!1),[c,g]=a.useState(""),[p,w]=a.useState("general"),[u,y]=a.useState(!1),[f,_]=a.useState(()=>{try{const t=localStorage.getItem("iman_dua_wall_prayed");if(t)return new Set(JSON.parse(t))}catch{}return new Set}),[$,j]=a.useState(null),N=a.useCallback(async()=>{try{const t=await fetch(`${b}/api/dua-wall`);if(t.ok){const s=await t.json();h(s)}}catch(t){console.error("Failed to fetch dua wall:",t)}finally{m(!1)}},[]);a.useEffect(()=>{N()},[N]);const v=a.useCallback(t=>{try{localStorage.setItem("iman_dua_wall_prayed",JSON.stringify([...t]))}catch{}},[]),P=a.useCallback(async()=>{if(u)return;const t=c.trim();if(!(t.length<3||t.length>500)){y(!0);try{const s=L(),r=await fetch(`${b}/api/dua-wall`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,category:p,telegramId:s?.id})});if(r.ok){const o=await r.json();h(A=>[o,...A]),g(""),w("general"),l(!1)}}catch(s){console.error("Failed to submit dua request:",s)}finally{y(!1)}}},[c,p,u]),T=a.useCallback(async t=>{if(f.has(t))return;j(t),h(r=>r.map(o=>o.id===t?{...o,pray_count:o.pray_count+1}:o));const s=new Set(f);s.add(t),_(s),v(s),setTimeout(()=>j(null),600);try{await fetch(`${b}/api/dua-wall/${t}/pray`,{method:"POST"})}catch(r){console.error("Failed to pray:",r)}},[f,v]),I=x.length,O=x.reduce((t,s)=>t+s.pray_count,0);return e.jsxs("div",{className:"min-h-screen pb-8 animate-fade-in",children:[e.jsx("header",{className:"sticky top-0 z-40 glass px-4 py-3",style:{borderBottom:"1px solid var(--border-secondary)"},children:e.jsxs("div",{className:"max-w-lg mx-auto flex items-center gap-3",children:[e.jsx("button",{onClick:()=>d(-1),className:"w-9 h-9 rounded-xl flex items-center justify-center hover:bg-white/5 active:scale-95 transition-all",children:e.jsx(R,{size:22,className:"text-white/70"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-bold text-white",children:"–°—Ç–µ–Ω–∞ –¥—É–∞"}),e.jsx("p",{className:"text-[11px] text-white/40 truncate",children:"–ü–æ–ø—Ä–æ—Å–∏—Ç–µ –¥—É–∞ —É –±—Ä–∞—Ç—å–µ–≤ –∏ —Å–µ—Å—Ç—ë—Ä"})]})]})}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 pt-4 space-y-4",children:[e.jsxs("div",{className:"glass-card p-3 flex items-center justify-around",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-white tabular-nums",children:I}),e.jsx("p",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"–ü—Ä–æ—Å—å–±"})]}),e.jsx("div",{className:"w-px h-8 bg-white/10"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl font-bold text-emerald-400 tabular-nums",children:O}),e.jsx("p",{className:"text-[10px] text-white/40 uppercase tracking-wider",children:"–î—É–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ"})]})]}),i&&e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(k,{size:28,className:"text-emerald-400 animate-spin"}),e.jsx("span",{className:"text-xs text-white/40",children:"–ó–∞–≥—Ä—É–∑–∫–∞..."})]})}),!i&&x.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-emerald-500/10 border border-emerald-500/20 flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-4xl",children:"ü§≤"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"–°—Ç–µ–Ω–∞ –¥—É–∞ –ø–æ–∫–∞ –ø—É—Å—Ç–∞"}),e.jsx("p",{className:"text-sm text-white/50 max-w-xs",children:"–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –ø–æ–ø—Ä–æ—Å–∏—Ç –¥—É–∞ —É –±—Ä–∞—Ç—å–µ–≤ –∏ —Å–µ—Å—Ç—ë—Ä. –í–∞—à–∞ –ø—Ä–æ—Å—å–±–∞ –±—É–¥–µ—Ç –∞–Ω–æ–Ω–∏–º–Ω–æ–π."}),e.jsxs("button",{onClick:()=>l(!0),className:"mt-6 px-6 py-3 rounded-2xl text-sm font-bold bg-emerald-500 hover:bg-emerald-400 text-white transition-all active:scale-[0.97] shadow-lg shadow-emerald-500/30 flex items-center gap-2",children:[e.jsx(S,{size:18}),"–ü–æ–ø—Ä–æ—Å–∏—Ç—å –¥—É–∞"]})]}),!i&&x.length>0&&e.jsx("div",{className:"space-y-3",children:x.map(t=>{const s=C[t.category]||C.general,r=f.has(t.id),o=$===t.id;return e.jsxs("div",{className:"glass-card p-4 space-y-3 relative overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:s.icon}),e.jsx("span",{className:"text-[11px] font-medium px-2 py-0.5 rounded-full bg-emerald-500/10 border border-emerald-500/20 text-emerald-400",children:s.label})]}),e.jsx("span",{className:"text-[10px] text-white/30",children:G(t.created_at)})]}),e.jsx("p",{className:"text-sm text-white/80 leading-relaxed",children:t.text}),e.jsxs("div",{className:"flex items-center justify-between pt-1",children:[e.jsx("span",{className:"text-[11px] text-white/25 italic",children:"–ê–Ω–æ–Ω–∏–º"}),e.jsxs("button",{onClick:()=>T(t.id),disabled:r,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-xl text-xs font-semibold transition-all duration-300 ${r?"bg-rose-500/15 border border-rose-500/25 text-rose-400 cursor-default":"bg-white/5 border border-white/10 text-white/60 hover:bg-rose-500/10 hover:border-rose-500/25 hover:text-rose-400 active:scale-95"}`,children:[e.jsx(F,{size:14,className:`transition-all duration-300 ${o?"scale-125":""} ${r?"fill-rose-400 text-rose-400":""}`,fill:r?"currentColor":"none"}),e.jsx("span",{className:"tabular-nums",children:t.pray_count}),!r&&e.jsx("span",{className:"text-[10px] text-white/30 ml-0.5",children:"–ü—Ä–æ—á–∏—Ç–∞–ª –¥—É–∞"})]})]})]},t.id)})})]}),!n&&!i&&e.jsx("button",{onClick:()=>l(!0),className:"fixed bottom-24 right-4 z-50 w-14 h-14 rounded-full bg-emerald-500 hover:bg-emerald-400 text-white shadow-lg shadow-emerald-500/40 flex items-center justify-center transition-all active:scale-90",children:e.jsx(S,{size:24})}),n&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/60 backdrop-blur-sm animate-fade-in",onClick:t=>{t.target===t.currentTarget&&l(!1)},children:e.jsxs("div",{className:"w-full max-w-lg rounded-t-3xl overflow-hidden",style:{background:"var(--bg-primary)",borderTop:"1px solid var(--border-secondary)"},children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"–ü–æ–ø—Ä–æ—Å–∏—Ç—å –¥—É–∞"}),e.jsx("button",{onClick:()=>l(!1),className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center hover:bg-white/10 active:scale-95 transition-all",children:e.jsx(M,{size:18,className:"text-white/50"})})]}),e.jsxs("div",{className:"px-5 pb-8 space-y-4",children:[e.jsxs("div",{children:[e.jsx("textarea",{value:c,onChange:t=>g(t.target.value),placeholder:"–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ—Å—å–±—É –æ –¥—É–∞... (–∞–Ω–æ–Ω–∏–º–Ω–æ)",maxLength:500,rows:4,className:"w-full px-4 py-3 rounded-2xl text-sm text-white placeholder-white/30 resize-none focus:outline-none focus:ring-2 focus:ring-emerald-500/50 transition-all",style:{background:"var(--bg-secondary)",border:"1px solid var(--border-secondary)"},autoFocus:!0}),e.jsxs("div",{className:"flex items-center justify-between mt-1.5 px-1",children:[e.jsx("span",{className:"text-[10px] text-white/30",children:c.trim().length<3?"–ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞":""}),e.jsxs("span",{className:`text-[10px] tabular-nums ${c.length>450?"text-amber-400":"text-white/30"}`,children:[c.length,"/500"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-white/40 mb-2 px-1",children:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:z.map(t=>e.jsxs("button",{onClick:()=>w(t.key),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-xl text-xs font-medium transition-all ${p===t.key?"bg-emerald-500/20 border border-emerald-500/40 text-emerald-400":"bg-white/5 border border-white/10 text-white/50 hover:bg-white/10"}`,children:[e.jsx("span",{className:"text-sm",children:t.icon}),t.label]},t.key))})]}),e.jsxs("button",{onClick:P,disabled:u||c.trim().length<3||c.trim().length>500,className:"w-full py-3.5 rounded-2xl text-sm font-bold bg-emerald-500 hover:bg-emerald-400 text-white transition-all active:scale-[0.97] shadow-lg shadow-emerald-500/30 flex items-center justify-center gap-2 disabled:opacity-40 disabled:cursor-not-allowed disabled:active:scale-100",children:[u?e.jsx(k,{size:18,className:"animate-spin"}):e.jsx(U,{size:18}),u?"–û—Ç–ø—Ä–∞–≤–∫–∞...":"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ—Å—å–±—É"]}),e.jsx("p",{className:"text-[10px] text-white/25 text-center px-4",children:"–í–∞—à–∞ –ø—Ä–æ—Å—å–±–∞ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞ –∞–Ω–æ–Ω–∏–º–Ω–æ. –ù–∏–∫—Ç–æ –Ω–µ —É–≤–∏–¥–∏—Ç –≤–∞—à–µ –∏–º—è."})]}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})}),e.jsx("style",{children:`
        @keyframes heart-pulse {
          0% { transform: scale(1); }
          25% { transform: scale(1.3); }
          50% { transform: scale(0.95); }
          100% { transform: scale(1); }
        }
      `})]})}export{X as default};
