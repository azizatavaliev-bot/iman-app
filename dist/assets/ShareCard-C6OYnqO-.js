import{c as T,j as t,X as U}from"./index-NuxdLuKF.js";import{b as j}from"./vendor-CpRrxz-h.js";import{S as _}from"./share-2-CUaH0vLH.js";const D=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],G=T("download",D);const H=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],O=T("palette",H),M=[{name:"Emerald",bg:"linear-gradient(135deg, #064e3b 0%, #0f766e 50%, #065f46 100%)",text:"#d1fae5",accent:"#6ee7b7"},{name:"Night",bg:"linear-gradient(135deg, #0f172a 0%, #1e1b4b 50%, #0c0a09 100%)",text:"#e2e8f0",accent:"#a78bfa"},{name:"Sunset",bg:"linear-gradient(135deg, #7c2d12 0%, #9a3412 50%, #78350f 100%)",text:"#fed7aa",accent:"#fdba74"},{name:"Ocean",bg:"linear-gradient(135deg, #0c4a6e 0%, #155e75 50%, #164e63 100%)",text:"#cffafe",accent:"#67e8f9"},{name:"Rose",bg:"linear-gradient(135deg, #4c0519 0%, #881337 50%, #831843 100%)",text:"#fce7f3",accent:"#f9a8d4"},{name:"Gold",bg:"linear-gradient(135deg, #451a03 0%, #78350f 50%, #713f12 100%)",text:"#fef3c7",accent:"#fbbf24"}];function q({type:d,arabic:r,text:x,source:m,surah:g,onClose:v}){const[A,L]=j.useState(0),[k,p]=j.useState(!1),S=j.useRef(null),a=M[A],N={hadith:"Хадис",ayat:"Аят Корана",dua:"Дуа",name:"Имя Аллаха",dhikr:"Зикр"},C=j.useCallback(async()=>{const n=S.current;if(!n)return null;const e=n.getContext("2d");if(!e)return null;const l=1080,c=1920;n.width=l,n.height=c;const f=a.bg.match(/linear-gradient\((\d+)deg,\s*(#\w+)\s+\d+%,\s*(#\w+)\s+\d+%,\s*(#\w+)\s+\d+%\)/),s=f?.[2]||"#064e3b",h=f?.[3]||"#0f766e",y=f?.[4]||"#065f46",u=e.createLinearGradient(0,0,l,c);u.addColorStop(0,s),u.addColorStop(.5,h),u.addColorStop(1,y),e.fillStyle=u,e.fillRect(0,0,l,c),e.globalAlpha=.04;for(let o=0;o<20;o++){const b=Math.random()*l,P=Math.random()*c,$=30+Math.random()*60;e.beginPath(),e.arc(b,P,$,0,Math.PI*2),e.strokeStyle="#ffffff",e.lineWidth=1,e.stroke()}e.globalAlpha=1,e.fillStyle=a.accent,e.fillRect(l/2-40,140,80,3),e.font="600 28px Inter, system-ui, sans-serif",e.fillStyle=a.accent,e.textAlign="center",e.fillText(N[d]||"Напоминание",l/2,200),e.font="48px serif",e.fillStyle=a.accent,e.globalAlpha=.6,e.fillText("﷽",l/2,290),e.globalAlpha=1;let i=380;if(r){e.font="700 52px 'Scheherazade New', 'Amiri', serif",e.fillStyle=a.accent,e.textAlign="center",e.direction="rtl";const o=I(e,r,l-160);for(const b of o)e.fillText(b,l/2,i),i+=72;e.direction="ltr",i+=30}e.fillStyle=a.accent,e.globalAlpha=.3,e.fillRect(l/2-60,i,120,2),e.globalAlpha=1,i+=50,e.font="500 36px Inter, system-ui, sans-serif",e.fillStyle=a.text,e.textAlign="center";const E=I(e,x,l-140);for(const o of E){if(i>c-350)break;e.fillText(o,l/2,i),i+=52}(m||g)&&(i+=30,e.font="italic 400 26px Inter, system-ui, sans-serif",e.fillStyle=a.accent,e.globalAlpha=.8,e.fillText(m||g||"",l/2,i),e.globalAlpha=1);const w=c-160;return e.fillStyle=a.accent,e.globalAlpha=.2,e.fillRect(80,w-30,l-160,1),e.globalAlpha=1,e.font="700 30px Inter, system-ui, sans-serif",e.fillStyle=a.accent,e.textAlign="center",e.fillText("IMAN App",l/2,w+20),e.font="400 22px Inter, system-ui, sans-serif",e.fillStyle=a.text,e.globalAlpha=.6,e.fillText("by Aziz Atavaliev  •  @ImanAppBot",l/2,w+60),e.globalAlpha=1,e.fillStyle=a.accent,e.fillRect(l/2-30,w+90,60,3),new Promise(o=>{n.toBlob(b=>o(b),"image/png",1)})},[a,r,x,m,g,d]);function I(n,e,l){const c=e.split(" "),f=[];let s="";for(const h of c){const y=s?s+" "+h:h;n.measureText(y).width>l&&s?(f.push(s),s=h):s=y}return s&&f.push(s),f}async function R(){p(!0);try{const n=await C();if(!n)return;const e=URL.createObjectURL(n),l=document.createElement("a");l.href=e,l.download=`iman-${d}-${Date.now()}.png`,l.click(),URL.revokeObjectURL(e)}finally{p(!1)}}async function z(){p(!0);try{const n=await C();if(!n)return;const e=new File([n],`iman-${d}.png`,{type:"image/png"});navigator.share&&navigator.canShare?.({files:[e]})?await navigator.share({title:`${N[d]} — IMAN App`,files:[e]}):R()}finally{p(!1)}}return t.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/70 backdrop-blur-sm",onClick:v,children:t.jsxs("div",{className:"w-full max-w-md bg-slate-900 rounded-t-3xl p-5 pb-8 animate-slide-up",onClick:n=>n.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-white font-bold text-lg",children:"Поделиться"}),t.jsx("button",{onClick:v,className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center",children:t.jsx(U,{className:"w-4 h-4 text-gray-400"})})]}),t.jsxs("div",{className:"rounded-2xl p-6 mb-4 min-h-[200px] flex flex-col items-center justify-center text-center",style:{background:a.bg},children:[t.jsx("div",{className:"text-xs font-semibold mb-2 opacity-80",style:{color:a.accent},children:N[d]}),r&&t.jsx("div",{className:"text-xl font-bold mb-3 leading-relaxed",style:{color:a.accent,direction:"rtl",fontFamily:"serif"},children:r.length>100?r.substring(0,100)+"...":r}),t.jsx("div",{className:"text-sm leading-relaxed mb-3",style:{color:a.text},children:x.length>150?x.substring(0,150)+"...":x}),(m||g)&&t.jsx("div",{className:"text-xs opacity-60",style:{color:a.accent},children:m||g}),t.jsxs("div",{className:"mt-4 pt-3 border-t border-white/10 w-full",children:[t.jsx("div",{className:"text-xs font-bold",style:{color:a.accent},children:"IMAN App"}),t.jsx("div",{className:"text-[10px] opacity-50",style:{color:a.text},children:"by Aziz Atavaliev"})]})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[t.jsx(O,{className:"w-4 h-4 text-gray-500"}),t.jsx("div",{className:"flex gap-2 flex-1",children:M.map((n,e)=>t.jsx("button",{onClick:()=>L(e),className:`flex-1 h-8 rounded-lg transition-all ${e===A?"ring-2 ring-white scale-105":"opacity-60"}`,style:{background:n.bg}},e))})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{onClick:R,disabled:k,className:"flex-1 py-3.5 rounded-xl bg-white/10 text-white font-semibold flex items-center justify-center gap-2 active:scale-95 transition-all disabled:opacity-50",children:[t.jsx(G,{className:"w-5 h-5"}),"Скачать"]}),t.jsxs("button",{onClick:z,disabled:k,className:"flex-1 py-3.5 rounded-xl bg-gradient-to-r from-emerald-600 to-teal-500 text-white font-semibold flex items-center justify-center gap-2 active:scale-95 transition-all disabled:opacity-50",children:[t.jsx(_,{className:"w-5 h-5"}),"Поделиться"]})]}),t.jsx("canvas",{ref:S,style:{display:"none"}})]})})}export{q as S};
