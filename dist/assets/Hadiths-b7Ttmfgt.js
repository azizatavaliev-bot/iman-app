import{c as de,q as oe,r as xe,s as h,t as me,j as e,v as B,w as p,L as X,H as f,P as $,C as G,x as be,y as ue,h as Q}from"./index-ClvlpEB5.js";import{b as l}from"./vendor-CpRrxz-h.js";import{S as pe}from"./ShareCard-C9bB_SuX.js";import{S as I}from"./share-2-UVW990nA.js";import{R as he}from"./refresh-cw-CSKVGsU1.js";const fe=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],ge=de("shuffle",fe),U="iman_hadiths_nawawi_read",V="iman_hadiths_ext_read";function je(){try{const d=localStorage.getItem(U);return d?JSON.parse(d):[]}catch{return[]}}function Ne(){try{const d=localStorage.getItem(V);return d?JSON.parse(d):[]}catch{return[]}}const D={nawawi:{label:"Навави (40)",subtitle:"40 хадисов ан-Навави",maxSection:0},bukhari:{label:"Бухари",subtitle:"Сахих аль-Бухари — 7563 хадиса",maxSection:97},muslim:{label:"Муслим",subtitle:"Сахих Муслим — 7563 хадиса",maxSection:56}};function Ce(){const[d,_]=l.useState("all"),[n,Z]=l.useState("nawawi"),[o,y]=l.useState(new Set),[T,ee]=l.useState([]),[r,te]=l.useState(null),[F,ae]=l.useState(null),[w,se]=l.useState(()=>new Set(je())),[x,g]=l.useState(1),[O,R]=l.useState([]),[S,A]=l.useState(!1),[k,L]=l.useState(null),[P,C]=l.useState(null),[c,M]=l.useState(null),[J,W]=l.useState(!1),[j,N]=l.useState(null);l.useEffect(()=>{ee(oe()),te(xe());const t=h.getFavoriteHadiths();y(new Set(t.map(a=>a.id)))},[]);const E=l.useCallback(async(t,a)=>{A(!0),L(null),C(null);try{const s=await me(t,a);R(s)}catch(s){L(s instanceof Error?s.message:"Ошибка загрузки хадисов"),R([])}finally{A(!1)}},[]);l.useEffect(()=>{(n==="bukhari"||n==="muslim")&&E(n,x)},[n,x,E]),l.useEffect(()=>{g(1),C(null),M(null)},[n]);const le=async()=>{p("medium"),W(!0);try{const a=await ue(n==="muslim"?"muslim":"bukhari");M(a)}catch{}finally{W(!1)}},z=(t,a)=>{a&&a.stopPropagation(),p("light");const s=String(t.id),i=o.has(s);h.toggleFavoriteHadith({id:s,collection:t.source,text:t.russian,narrator:t.narrator}),y(m=>{const b=new Set(m);return i?b.delete(s):b.add(s),b})},K=(t,a)=>{a&&a.stopPropagation(),p("light");const s=`${t.collection}_${t.hadithnumber}`,i=o.has(s),m=t.collection==="bukhari"?"Сахих аль-Бухари":"Сахих Муслим";h.toggleFavoriteHadith({id:s,collection:m,text:t.text,narrator:""}),y(b=>{const u=new Set(b);return i?u.delete(s):u.add(s),u})},ne=t=>{const a=F===t.id;if(ae(a?null:t.id),!a&&!w.has(t.id)){h.addExtraPoints($.HADITH);const s=new Set(w).add(t.id);se(s),localStorage.setItem(U,JSON.stringify(Array.from(s))),Q()}},[Y,ie]=l.useState(()=>new Set(Ne())),re=t=>{const a=`${t.collection}_${t.hadithnumber}`,s=P===a;if(C(s?null:a),!s&&!Y.has(a)){h.addExtraPoints($.HADITH);const i=new Set(Y).add(a);ie(i),localStorage.setItem(V,JSON.stringify(Array.from(i))),Q()}},q=d==="favorites"?T.filter(t=>o.has(String(t.id))):T,v=D[n].maxSection,ce=Array.from({length:v},(t,a)=>a+1),H=n==="bukhari"||n==="muslim";return e.jsxs("div",{className:"min-h-screen pb-28 px-4 pt-6 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 animate-fade-in",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-500/10 flex items-center justify-center",children:e.jsx(B,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Хадисы"}),e.jsx("p",{className:"text-xs text-slate-400",children:D[n].subtitle})]})]}),e.jsx("div",{className:"flex gap-1 p-1 rounded-xl t-bg mb-4 animate-fade-in",style:{animationDelay:"0.03s"},children:Object.entries(D).map(([t,a])=>e.jsx("button",{onClick:()=>{Z(t),_("all"),p("light")},className:`flex-1 py-2 text-xs font-medium rounded-lg transition-all duration-200 ${n===t?"bg-amber-500/20 text-amber-400 shadow-sm":"text-slate-400 hover:text-slate-300"}`,children:a.label},t))}),H&&e.jsx("div",{className:"mb-4 animate-fade-in",style:{animationDelay:"0.05s"},children:e.jsxs("button",{onClick:le,disabled:J,className:"w-full flex items-center justify-center gap-2 py-2.5 rounded-xl bg-emerald-500/10 text-emerald-400 text-sm font-medium hover:bg-emerald-500/20 transition-all active:scale-[0.98] disabled:opacity-50",children:[J?e.jsx(X,{className:"w-4 h-4 animate-spin"}):e.jsx(ge,{className:"w-4 h-4"}),"Случайный хадис"]})}),c&&H&&e.jsxs("div",{className:"relative mb-5 rounded-2xl overflow-hidden animate-fade-in",style:{animationDelay:"0.05s"},children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl p-[1.5px] pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 rounded-2xl",style:{background:"linear-gradient(135deg, rgba(16,185,129,0.6), rgba(5,150,105,0.3), rgba(16,185,129,0.6))",mask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",maskComposite:"exclude",WebkitMaskComposite:"xor",padding:"1.5px"}})}),e.jsxs("div",{className:"relative glass-card rounded-2xl p-5 border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-widest text-emerald-400/90",children:"Случайный хадис"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[10px] font-medium text-slate-500 t-bg px-2 py-0.5 rounded-full",children:["#",c.hadithnumber]}),e.jsx("button",{onClick:t=>K(c,t),className:"p-1.5 rounded-full hover:t-bg transition-colors active:scale-90",children:e.jsx(f,{className:`w-4 h-4 transition-all duration-300 ${o.has(`${c.collection}_${c.hadithnumber}`)?"fill-red-500 text-red-500 scale-110":"text-slate-500 hover:text-red-400"}`})})]})]}),c.arabicText&&e.jsx("p",{className:"arabic-text text-lg text-amber-100/90 mb-4 leading-[2.2] text-center",children:c.arabicText}),e.jsxs("div",{className:"flex items-center gap-3 my-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-emerald-500/30 to-transparent"}),e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500/40"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-emerald-500/30 to-transparent"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed mb-3",children:c.text}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t t-border",children:[e.jsxs("span",{className:"text-[10px] text-slate-500",children:["Книга ",c.book]}),e.jsx("span",{className:"text-[11px] font-medium text-emerald-500/70 bg-emerald-500/10 px-2.5 py-1 rounded-full",children:c.collection==="bukhari"?"Аль-Бухари":"Муслим"})]})]})]}),n==="nawawi"&&e.jsxs(e.Fragment,{children:[r&&e.jsxs("div",{className:"relative mb-6 rounded-2xl overflow-hidden animate-fade-in",style:{animationDelay:"0.05s"},children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl p-[1.5px] pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 rounded-2xl",style:{background:"linear-gradient(135deg, rgba(245,158,11,0.6), rgba(217,119,6,0.3), rgba(245,158,11,0.6))",mask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",maskComposite:"exclude",WebkitMaskComposite:"xor",padding:"1.5px"}})}),e.jsxs("div",{className:"relative glass-card rounded-2xl p-5 glow-gold border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-widest text-amber-400/90",children:"Хадис дня"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:t=>{t.stopPropagation(),N({arabic:r.arabic,text:r.russian,source:r.source})},className:"p-1.5 rounded-full hover:t-bg transition-all active:scale-90","aria-label":"Поделиться",children:e.jsx(I,{className:"w-4 h-4 text-slate-500 hover:text-emerald-400"})}),e.jsx("button",{onClick:t=>z(r,t),className:"p-1.5 rounded-full hover:t-bg transition-colors active:scale-90","aria-label":"В избранное",children:e.jsx(f,{className:`w-5 h-5 transition-all duration-300 ${o.has(String(r.id))?"fill-red-500 text-red-500 scale-110":"text-slate-500 hover:text-red-400"}`})})]})]}),e.jsx("p",{className:"arabic-text text-xl text-amber-100/90 mb-4 leading-[2.2] text-center",children:r.arabic}),e.jsxs("div",{className:"flex items-center gap-3 my-4",children:[e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-amber-500/30 to-transparent"}),e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-amber-500/40"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-amber-500/30 to-transparent"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed mb-4",children:r.russian}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t t-border",children:[e.jsx("p",{className:"text-[11px] text-slate-500 leading-snug max-w-[65%]",children:r.narrator}),e.jsx("span",{className:"text-[11px] font-medium text-amber-500/70 bg-amber-500/10 px-2.5 py-1 rounded-full",children:r.source})]})]})]}),e.jsx("div",{className:"flex gap-1 p-1 rounded-xl t-bg mb-5 animate-fade-in",style:{animationDelay:"0.1s"},children:[{key:"all",label:"Все"},{key:"favorites",label:"Избранное"}].map(({key:t,label:a})=>e.jsxs("button",{onClick:()=>_(t),className:`flex-1 py-2 text-sm font-medium rounded-lg transition-all duration-200 ${d===t?"bg-emerald-500/20 text-emerald-400 shadow-sm":"text-slate-400 hover:text-slate-300"}`,children:[a,t==="favorites"&&o.size>0&&e.jsx("span",{className:"ml-1.5 text-[10px] bg-red-500/20 text-red-400 px-1.5 py-0.5 rounded-full",children:o.size})]},t))}),e.jsxs("div",{className:"space-y-3",children:[q.length===0&&d==="favorites"&&e.jsxs("div",{className:"glass-card p-8 text-center animate-fade-in",style:{animationDelay:"0.15s"},children:[e.jsx(f,{className:"w-10 h-10 text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Нет избранных хадисов"}),e.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"Нажмите на сердечко, чтобы сохранить"})]}),q.map((t,a)=>{const s=F===t.id,i=o.has(String(t.id));return e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${.08+a*.04}s`,opacity:0},children:e.jsxs("div",{className:`glass-card p-4 cursor-pointer transition-all duration-300 ${s?"ring-1 ring-emerald-500/20 bg-gradient-to-br from-white/[0.07] to-white/[0.02]":"hover:bg-white/[0.04] active:scale-[0.99]"}`,onClick:()=>ne(t),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-emerald-500/10 flex items-center justify-center shrink-0",children:e.jsx("span",{className:"text-xs font-bold text-emerald-400",children:t.number})}),e.jsx("span",{className:"text-[11px] font-medium text-slate-500 t-bg px-2 py-0.5 rounded-full",children:t.source}),w.has(t.id)&&e.jsxs("span",{className:"text-[10px] text-emerald-500/60",children:["+",$.HADITH]})]}),e.jsx("button",{onClick:m=>z(t,m),className:"p-1.5 rounded-full hover:t-bg transition-all active:scale-90","aria-label":"В избранное",children:e.jsx(f,{className:`w-4 h-4 transition-all duration-300 ${i?"fill-red-500 text-red-500 scale-110":"text-slate-600 hover:text-red-400"}`})})]}),e.jsx("p",{className:`arabic-text text-amber-100/80 mb-2 text-center transition-all duration-300 ${s?"text-lg leading-[2.2]":"text-base leading-[2] line-clamp-2"}`,children:t.arabic}),e.jsxs("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${s?"max-h-[600px] opacity-100 mt-3":"max-h-0 opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-emerald-500/20 to-transparent"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-emerald-500/30"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-emerald-500/20 to-transparent"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed mb-3",children:t.russian}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-[11px] text-slate-500 leading-snug",children:t.narrator}),e.jsx("button",{onClick:m=>{m.stopPropagation(),N({arabic:t.arabic,text:t.russian,source:t.source})},className:"p-1.5 rounded-full hover:t-bg transition-all active:scale-90","aria-label":"Поделиться",children:e.jsx(I,{className:"w-4 h-4 text-slate-500 hover:text-emerald-400"})})]})]}),!s&&e.jsx("p",{className:"text-[11px] text-slate-600 mt-1.5 text-center",children:"Нажмите, чтобы прочитать перевод"})]})},t.id)})]})]}),H&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 animate-fade-in",style:{animationDelay:"0.07s"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"Раздел (книга)"}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:[x," из ",v]})]}),e.jsx("div",{className:"flex gap-1.5 overflow-x-auto pb-2 scrollbar-hide -mx-1 px-1",children:ce.map(t=>e.jsx("button",{onClick:()=>{g(t),p("light")},className:`shrink-0 min-w-[36px] h-8 px-2 rounded-lg text-xs font-medium transition-all duration-200 ${x===t?"bg-amber-500/20 text-amber-400 shadow-sm ring-1 ring-amber-500/30":"t-bg text-slate-500 hover:text-slate-300 hover:t-bg"}`,children:t},t))})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4 animate-fade-in",style:{animationDelay:"0.09s"},children:[e.jsxs("button",{onClick:()=>{x>1&&(g(t=>t-1),p("light"))},disabled:x<=1,className:"flex-1 flex items-center justify-center gap-1 py-2 rounded-xl t-bg text-slate-400 text-xs font-medium hover:t-bg transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:[e.jsx(G,{className:"w-3.5 h-3.5"}),"Пред. раздел"]}),e.jsxs("button",{onClick:()=>{x<v&&(g(t=>t+1),p("light"))},disabled:x>=v,className:"flex-1 flex items-center justify-center gap-1 py-2 rounded-xl t-bg text-slate-400 text-xs font-medium hover:t-bg transition-all disabled:opacity-30 disabled:cursor-not-allowed",children:["След. раздел",e.jsx(G,{className:"w-3.5 h-3.5 rotate-180"})]})]}),S&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 animate-fade-in",children:[e.jsx(X,{className:"w-8 h-8 text-amber-400 animate-spin mb-3"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Загрузка хадисов..."})]}),k&&!S&&e.jsxs("div",{className:"glass-card p-6 text-center animate-fade-in",children:[e.jsx(be,{className:"w-10 h-10 text-red-400/60 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-red-400 mb-1",children:"Ошибка загрузки"}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:k}),e.jsxs("button",{onClick:()=>E(n,x),className:"inline-flex items-center gap-1.5 px-4 py-2 rounded-xl bg-amber-500/10 text-amber-400 text-sm font-medium hover:bg-amber-500/20 transition-all active:scale-95",children:[e.jsx(he,{className:"w-3.5 h-3.5"}),"Попробовать снова"]})]}),!S&&!k&&e.jsxs("div",{className:"space-y-3",children:[O.length===0&&e.jsxs("div",{className:"glass-card p-8 text-center animate-fade-in",children:[e.jsx(B,{className:"w-10 h-10 text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"В этом разделе нет хадисов"}),e.jsx("p",{className:"text-slate-500 text-xs mt-1",children:"Выберите другой раздел"})]}),O.map((t,a)=>{const s=`${t.collection}_${t.hadithnumber}`,i=P===s,m=o.has(s),b=t.collection==="bukhari"?"Аль-Бухари":"Муслим";return e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${.08+Math.min(a,15)*.03}s`,opacity:0},children:e.jsxs("div",{className:`glass-card p-4 cursor-pointer transition-all duration-300 ${i?"ring-1 ring-amber-500/20 bg-gradient-to-br from-white/[0.07] to-white/[0.02]":"hover:bg-white/[0.04] active:scale-[0.99]"}`,onClick:()=>re(t),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-amber-500/10 flex items-center justify-center shrink-0",children:e.jsx("span",{className:"text-xs font-bold text-amber-400",children:t.hadithnumber})}),e.jsx("span",{className:"text-[11px] font-medium text-amber-500/70 bg-amber-500/10 px-2 py-0.5 rounded-full",children:b})]}),e.jsx("button",{onClick:u=>K(t,u),className:"p-1.5 rounded-full hover:t-bg transition-all active:scale-90","aria-label":"В избранное",children:e.jsx(f,{className:`w-4 h-4 transition-all duration-300 ${m?"fill-red-500 text-red-500 scale-110":"text-slate-600 hover:text-red-400"}`})})]}),t.arabicText&&e.jsx("p",{className:`arabic-text text-amber-100/80 mb-2 text-center transition-all duration-300 ${i?"text-lg leading-[2.2]":"text-base leading-[2] line-clamp-2"}`,children:t.arabicText}),e.jsxs("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${i?"max-h-[800px] opacity-100 mt-3":"max-h-0 opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-amber-500/20 to-transparent"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-amber-500/30"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-transparent via-amber-500/20 to-transparent"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed mb-3",children:t.text}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t t-border",children:[e.jsxs("span",{className:"text-[10px] text-slate-500",children:["Книга ",t.book]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-[10px] text-slate-500",children:["Арабский #",t.arabicnumber]}),e.jsx("button",{onClick:u=>{u.stopPropagation(),N({arabic:t.arabicText||"",text:t.text,source:b})},className:"p-1.5 rounded-full hover:t-bg transition-all active:scale-90","aria-label":"Поделиться",children:e.jsx(I,{className:"w-4 h-4 text-slate-500 hover:text-emerald-400"})})]})]})]}),!i&&e.jsx("p",{className:"text-[11px] text-slate-600 mt-1.5 text-center",children:"Нажмите, чтобы прочитать перевод"})]})},s)})]})]}),e.jsx("div",{className:"h-8"}),j&&e.jsx(pe,{type:"hadith",arabic:j.arabic,text:j.text,source:j.source,onClose:()=>N(null)})]})}export{Ce as default};
