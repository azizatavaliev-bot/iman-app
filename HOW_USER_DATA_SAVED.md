# üîê –ö–ê–ö –°–û–•–†–ê–ù–Ø–Æ–¢–°–Ø –ë–ê–õ–õ–´ –ö–ê–ñ–î–û–ì–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

## üì± –®–ê–ì 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram                           ‚îÇ
‚îÇ  ‚îú‚îÄ User ID: 508698471             ‚îÇ ‚Üê –£–ù–ò–ö–ê–õ–¨–ù–´–ô –ù–û–ú–ï–† (–Ω–µ –º–µ–Ω—è–µ—Ç—Å—è!)
‚îÇ  ‚îú‚îÄ –ò–º—è: –ê–∑–∏–∑                      ‚îÇ
‚îÇ  ‚îî‚îÄ Username: @atavaliev           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
    IMAN App –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
```

**Telegram ID = 508698471** ‚Äî —ç—Ç–æ –∫–∞–∫ –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–π –Ω–æ–º–µ—Ä, –ù–ò–ö–û–ì–î–ê –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è!

---

## üíæ –®–ê–ì 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Äî –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ?

```javascript
// –í src/lib/sync.ts:

export async function syncUserData() {
  // 1. –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
  const telegramId = getTelegramId(); // –ù–∞–ø—Ä–∏–º–µ—Ä: 508698471
  
  // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º ‚Äî –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?
  const serverData = await fetch(`/api/user/${telegramId}`);
  
  // 3. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –ù–ï–¢ ‚Äî —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
  // 4. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ï–°–¢–¨ ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ–º –∏—Ö
}
```

**–ó–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É:**
```
GET /api/user/508698471
```

---

## üóÑÔ∏è –®–ê–ì 3: –ü–æ–∏—Å–∫ –≤ PostgreSQL

```javascript
// –í server.js:

// –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ Telegram ID
const result = await pool.query(
  "SELECT data, updated_at FROM users WHERE telegram_id = $1",
  [508698471]  // ‚Üê –ò—â–µ–º –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º—É ID
);
```

**SQL –∑–∞–ø—Ä–æ—Å:**
```sql
SELECT data, updated_at 
FROM users 
WHERE telegram_id = 508698471
```

**–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º:**
```json
{
  "data": {
    "name": "–ê–∑–∏–∑",
    "totalPoints": 1850,
    "level": "–ü—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–π",
    "streak": 12,
    "prayerLogs": {...},
    "habitLogs": {...}
  },
  "updated_at": 1708275234567
}
```

**–ï—Å–ª–∏ –ù–ï –Ω–∞–π–¥–µ–Ω ‚Äî —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å!**

---

## ‚ûï –®–ê–ì 4: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –±–∞–ª–ª—ã

```javascript
// –ü—Ä–∏–º–µ—Ä: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ—Ç–∏–ª –Ω–∞–º–∞–∑ –§–∞–¥–∂—Ä

// 1. –í –±—Ä–∞—É–∑–µ—Ä–µ (src/lib/storage.ts):
addPoints(18, "prayer_fajr"); // +18 –±–∞–ª–ª–æ–≤

// 2. –û–±–Ω–æ–≤–ª—è–µ–º localStorage:
localStorage.setItem("iman_profile", JSON.stringify({
  name: "–ê–∑–∏–∑",
  totalPoints: 1850 + 18, // = 1868 –±–∞–ª–ª–æ–≤!
  level: "–ü—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–π",
  ...
}));

// 3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
syncUserData(); // –ß–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
```

---

## üì§ –®–ê–ì 5: –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```javascript
// –í src/lib/sync.ts:

async function pushToServer(telegramId) {
  const data = gatherLocalData(); // –°–æ–±–∏—Ä–∞–µ–º –í–°–ï –¥–∞–Ω–Ω—ã–µ
  
  await fetch(`/api/user/${telegramId}`, {
    method: "POST",
    body: JSON.stringify({ data })
  });
}
```

**–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è:**
```json
{
  "data": {
    "name": "–ê–∑–∏–∑",
    "totalPoints": 1868,  // ‚Üê –û–ë–ù–û–í–õ–Å–ù–ù–´–ï –ë–ê–õ–õ–´!
    "level": "–ü—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–π",
    "streak": 12,
    "prayerLogs": {
      "2026-02-18": {
        "fajr": true,  // ‚Üê –¢–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–º–µ—Ç–∏–ª–∏!
        "dhuhr": false,
        ...
      }
    }
  }
}
```

---

## üíæ –®–ê–ì 6: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL

```javascript
// –í server.js:

await pool.query(
  `INSERT INTO users (telegram_id, data, updated_at)
   VALUES ($1, $2, $3)
   ON CONFLICT (telegram_id) 
   DO UPDATE SET 
     data = EXCLUDED.data,
     updated_at = EXCLUDED.updated_at`,
  [508698471, JSON.stringify(data), Date.now()]
);
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ PostgreSQL:**

```sql
-- –ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –ù–ï–¢ ‚Äî —Å–æ–∑–¥–∞—ë–º:
INSERT INTO users VALUES (
  508698471,                    -- telegram_id (–£–ù–ò–ö–ê–õ–¨–ù–´–ô!)
  '{"totalPoints":1868,...}',   -- –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
  1708275234567                 -- –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
);

-- –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –ï–°–¢–¨ ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º:
UPDATE users 
SET 
  data = '{"totalPoints":1868,...}',  -- –ù–û–í–´–ï –¥–∞–Ω–Ω—ã–µ
  updated_at = 1708275234567          -- –ù–û–í–û–ï –≤—Ä–µ–º—è
WHERE telegram_id = 508698471;        -- –ü–û –£–ù–ò–ö–ê–õ–¨–ù–û–ú–£ ID!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**

| telegram_id | data | updated_at |
|-------------|------|------------|
| 508698471 | `{"name":"–ê–∑–∏–∑","totalPoints":1868,"level":"–ü—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–π"...}` | 1708275234567 |
| 542914483 | `{"name":"–ê–∫—ã–ª–∞–π","totalPoints":450,"level":"–ù–∞—á–∏–Ω–∞—é—â–∏–π"...}` | 1708274000000 |
| 123456789 | `{"name":"–ò–±—Ä–∞–≥–∏–º","totalPoints":2200,"level":"–ú—É'–º–∏–Ω"...}` | 1708273000000 |

---

## üîÑ –ü–û–õ–ù–´–ô –¶–ò–ö–õ (–æ—Ç –¥–µ–π—Å—Ç–≤–∏—è –¥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è):

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ—Ç–∏–ª –Ω–∞–º–∞–∑ (+18 –±–∞–ª–ª–æ–≤)
   ‚îÇ
   ‚ñº
2. localStorage: totalPoints = 1850 + 18 = 1868 ‚úÖ
   ‚îÇ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –æ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç)
   ‚ñº
3. –ß–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥: –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   ‚îÇ
   ‚ñº
4. API: POST /api/user/508698471
   ‚îÇ { data: { totalPoints: 1868 } }
   ‚ñº
5. PostgreSQL: UPDATE users SET data = '...' WHERE telegram_id = 508698471
   ‚îÇ
   ‚ñº
6. –°–û–•–†–ê–ù–ï–ù–û –ù–ê–í–°–ï–ì–î–ê! ‚úÖ
```

---

## üîê –ü–û–ß–ï–ú–£ –î–ê–ù–ù–´–ï –ù–ï –ü–û–¢–ï–†–Ø–Æ–¢–°–Ø:

### 1. Telegram ID –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
- –ú–æ–∂–µ—Ç –ø–æ–º–µ–Ω—è—Ç—å –∏–º—è ‚úÖ
- –ú–æ–∂–µ—Ç –ø–æ–º–µ–Ω—è—Ç—å username ‚úÖ
- –ú–æ–∂–µ—Ç –ø–æ–º–µ–Ω—è—Ç—å —Ñ–æ—Ç–æ ‚úÖ
- –ù–û! Telegram ID = 508698471 –ù–ê–í–°–ï–ì–î–ê! üîí
```

### 2. PostgreSQL –∏—â–µ—Ç –ø–æ Telegram ID
```sql
WHERE telegram_id = 508698471  -- –í—Å–µ–≥–¥–∞ –Ω–∞–π–¥—ë—Ç –≠–¢–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!
```

### 3. ON CONFLICT ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç, –∞ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –¥—É–±–ª–∏–∫–∞—Ç
```sql
ON CONFLICT (telegram_id)      -- –ï—Å–ª–∏ ID —É–∂–µ –µ—Å—Ç—å
DO UPDATE SET data = ...       -- –û–ë–ù–û–í–õ–Ø–ï–ú, –∞ –Ω–µ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
```

### 4. –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 1 (ID: 508698471) ‚Üí –°–≤–æ—è –∑–∞–ø–∏—Å—å –≤ –ë–î
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 2 (ID: 542914483) ‚Üí –°–≤–æ—è –∑–∞–ø–∏—Å—å –≤ –ë–î
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 3 (ID: 123456789) ‚Üí –°–≤–æ—è –∑–∞–ø–∏—Å—å –≤ –ë–î

–û–ù–ò –ù–ï –°–ú–ï–®–ò–í–ê–Æ–¢–°–Ø! ‚úÖ
```

---

## üìä –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨ –°–í–û–ò –ë–ê–õ–õ–´ –í –ë–ê–ó–ï:

```sql
-- –ú–æ–∏ –±–∞–ª–ª—ã (–ê–∑–∏–∑):
SELECT 
  data->>'name' as –∏–º—è,
  (data->>'totalPoints')::int as –±–∞–ª–ª—ã,
  data->>'level' as —É—Ä–æ–≤–µ–Ω—å
FROM users
WHERE telegram_id = 508698471;

-- –†–µ–∑—É–ª—å—Ç–∞—Ç:
-- –∏–º—è   | –±–∞–ª–ª—ã | —É—Ä–æ–≤–µ–Ω—å
-- –ê–∑–∏–∑  | 1868  | –ü—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–π
```

---

## üö® –ß–¢–û –ï–°–õ–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ü–ï–†–ï–£–°–¢–ê–ù–û–í–ò–¢ –ü–†–ò–õ–û–ñ–ï–ù–ò–ï?

```
1. Telegram ID –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ—Ç –∂–µ (508698471)
   ‚îÇ
   ‚ñº
2. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è ‚Üí syncUserData()
   ‚îÇ
   ‚ñº
3. –ó–∞–ø—Ä–æ—Å: GET /api/user/508698471
   ‚îÇ
   ‚ñº
4. PostgreSQL –Ω–∞—Ö–æ–¥–∏—Ç –∑–∞–ø–∏—Å—å: ‚úÖ
   {
     "totalPoints": 1868,
     "level": "–ü—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–π",
     "streak": 12
   }
   ‚îÇ
   ‚ñº
5. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ!
   ‚îÇ
   ‚ñº
6. –í–°–ï –ë–ê–õ–õ–´ –ù–ê –ú–ï–°–¢–ï! ‚úÖ
```

---

## üéØ –í–´–í–û–î:

### ‚úÖ –ö–ê–ñ–î–´–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ = –°–í–û–Ø –ó–ê–ü–ò–°–¨ –í –ë–î

```
Telegram ID ‚Üí –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á ‚Üí –ü–æ–∏—Å–∫ –≤ PostgreSQL ‚Üí –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
508698471   ‚Üí PRIMARY KEY     ‚Üí WHERE telegram_id  ‚Üí {"totalPoints":1868}
```

### ‚úÖ –ë–ê–õ–õ–´ –ü–†–ò–í–Ø–ó–ê–ù–´ –ö TELEGRAM ID

- ID –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –ù–ò–ö–û–ì–î–ê
- PostgreSQL –∏—â–µ—Ç –ø–æ ID
- ON CONFLICT –æ–±–Ω–æ–≤–ª—è–µ—Ç, –∞ –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç
- –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### ‚úÖ –î–ê–ñ–ï –ï–°–õ–ò:

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Üí Telegram ID –æ—Å—Ç–∞–ª—Å—è ‚Üí –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è ‚úÖ
- –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è ‚Üí PostgreSQL –Ω–µ–∑–∞–≤–∏—Å–∏–º ‚Üí –î–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Å—Ç–µ ‚úÖ
- –î–µ–ø–ª–æ–π –ø—Ä–æ–π–¥—ë—Ç ‚Üí PostgreSQL –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç—Å—è ‚Üí –î–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Å—Ç–µ ‚úÖ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–π–¥—ë—Ç —Å –¥—Ä—É–≥–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ ‚Üí –¢–æ—Ç –∂–µ Telegram ID ‚Üí –î–∞–Ω–Ω—ã–µ —Ç–µ –∂–µ ‚úÖ

---

**–ë–ê–õ–õ–´ –ö–ê–ñ–î–û–ì–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø –°–û–•–†–ê–ù–Ø–Æ–¢–°–Ø –ü–û –ï–ì–û –£–ù–ò–ö–ê–õ–¨–ù–û–ú–£ TELEGRAM ID!** üîí

**–ù–ï–í–û–ó–ú–û–ñ–ù–û –ü–û–¢–ï–†–Ø–¢–¨ –ò–õ–ò –ü–ï–†–ï–ü–£–¢–ê–¢–¨ –î–ê–ù–ù–´–ï!** ‚úÖ
