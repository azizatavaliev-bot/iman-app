# Admin Panel Setup Guide

## Как добавить себя в администраторы

### Шаг 1: Получите свой Telegram ID

1. Откройте IMAN App в Telegram
2. Откройте консоль браузера (F12 или Cmd+Option+I на Mac)
3. В консоли выполните:
   ```javascript
   getTelegramUser()
   ```
4. Скопируйте значение поля `id` (например: `123456789`)

### Шаг 2: Добавьте свой ID в конфиг

1. Откройте файл `src/lib/adminConfig.ts`
2. Добавьте свой Telegram ID в массив `ADMIN_TELEGRAM_IDS`:

```typescript
export const ADMIN_TELEGRAM_IDS = [
  123456789, // Замените на ваш Telegram ID
];
```

3. Сохраните файл

### Шаг 3: Пересоберите приложение

```bash
npm run build
```

### Шаг 4: Перезапустите сервер

```bash
npm start
```

## Доступ к админ-панели

После настройки:

1. Откройте IMAN App
2. Перейдите в **Профиль**
3. Внизу появится красная кнопка **"Админ-панель"**
4. Нажмите на неё для просмотра статистики

## Функции админ-панели

### Overview Cards
- **Всего пользователей** — общее количество зарегистрированных
- **Активны сегодня** — пользователи с активностью за последние 24 часа
- **Активны 7 дней** — активность за неделю
- **Активны 30 дней** — активность за месяц

### Средние показатели
- Средний уровень пользователей
- Средние очки
- Средняя серия

### Топ функций
Рейтинг самых используемых функций приложения:
- Намазы
- Коран
- Азкар
- Дуа
- Привычки

### Таблица пользователей
Полный список всех пользователей с:
- Telegram ID
- Имя
- Уровень
- Очки
- Серия (текущая/рекордная)
- Количество намазов
- Количество привычек
- Последний визит
- Дата регистрации

**Возможности:**
- Поиск по имени
- Сортировка по очкам, намазам, последнему визиту
- Пагинация (20 пользователей на страницу)
- Адаптивный дизайн (таблица на десктопе, карточки на мобильном)

## Безопасность

- Доступ к админ-панели **только** у пользователей из списка `ADMIN_TELEGRAM_IDS`
- Проверка прав происходит на клиенте и при загрузке страницы
- Обычные пользователи перенаправляются на главную

## API Endpoint

Админ-панель использует серверный endpoint:

```
GET /api/admin/users
```

Возвращает:
```json
{
  "users": [
    {
      "telegram_id": 123456789,
      "data": "{...}",
      "updated_at": 1234567890000
    }
  ]
}
```

## Troubleshooting

### Кнопка "Админ-панель" не появляется
- Убедитесь, что вы добавили свой Telegram ID в `adminConfig.ts`
- Проверьте, что ID введён без ошибок (число, не строка)
- Пересоберите приложение: `npm run build`

### Ошибка "Не удалось загрузить данные"
- Проверьте, что сервер запущен
- Убедитесь, что база данных SQLite создана (`data/iman.db`)
- Проверьте консоль сервера на наличие ошибок

### Пустой список пользователей
- Если в базе данных ещё нет пользователей, список будет пустым
- Пользователи появятся после первой синхронизации данных (при запуске приложения в Telegram)
